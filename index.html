<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geleceğin Mirası: Sen ve Milletin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        
        :root {
            --primary-color: #2c5282;
            --secondary-color: #f7fafc;
            --accent-color: #d1d5db;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --background-start: #0f172a;
            --background-end: #1e293b;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--background-start), var(--background-end));
            color: var(--secondary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            flex-direction: column;
            overflow-x: hidden;
            position: relative;
        }

        .game-container {
            width: 100%;
            max-width: 1200px;
            background-color: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            gap: 2rem;
            min-height: 80vh;
        }

        .parallax-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background-size: cover;
            background-position: center;
            transition: background-image 1s ease-in-out;
            z-index: -1;
        }

        .layer-1 { background-image: url('https://placehold.co/1920x1080/003459/FFF?text=+'); z-index: -3; }
        .layer-2 { background-image: url('https://placehold.co/1920x1080/007EA7/FFF?text='); z-index: -2; }
        .layer-3 { background-image: url('https://placehold.co/1920x1080/63c5da/FFF?text='); z-index: -1; }

        .game-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #ffffff;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .pillar-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .pillar-card {
            background-color: rgba(45, 62, 80, 0.7);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s ease-in-out;
        }

        .pillar-card:hover {
            transform: translateY(-5px);
        }

        .pillar-card h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .progress-bar-container {
            width: 100%;
            background-color: #4b5563;
            border-radius: 9999px;
            height: 1rem;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--success-color);
            transition: width 0.5s ease-in-out;
        }

        .stats-and-actions {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .stats-panel {
            background-color: rgba(45, 62, 80, 0.7);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .project-panel {
            background-color: rgba(45, 62, 80, 0.7);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .project-card {
            background-color: rgba(67, 86, 107, 0.7);
            border-radius: 0.5rem;
            padding: 1rem;
            transition: transform 0.2s;
            cursor: pointer;
        }

        .project-card:hover {
            transform: translateY(-3px);
            background-color: rgba(67, 86, 107, 0.9);
        }

        .message-log {
            min-height: 100px;
            background-color: rgba(45, 62, 80, 0.7);
            border-radius: 0.75rem;
            padding: 1.5rem;
            overflow-y: auto;
            max-height: 200px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        
        button {
            transition: all 0.2s;
            background-color: var(--primary-color);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 700;
        }
        
        button:hover:not(:disabled) {
            background-color: #1e3a5f;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        button:disabled {
            background-color: #4b5563;
            cursor: not-allowed;
        }
        
        /* Bu kısım düzeltildi. info-box kaldırılıp hidden sınıfı eklendi. */
        .info-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(5px);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.7);
            text-align: center;
            z-index: 100;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-900">

    <div class="parallax-layer layer-1"></div>
    <div class="parallax-layer layer-2"></div>
    <div class="parallax-layer layer-3"></div>

    <div id="start-screen" class="info-box p-8 w-11/12 md:w-1/2">
        <h2 class="text-3xl font-bold mb-4">Geleceğin Mirası: Sen ve Milletin</h2>
        <p class="mb-6">
            Ulusunuzun kaderi sizin ellerinizde. Toplumsal Mutluluk, Doğa Dengesi, Teknoloji ve Küresel İtibar olmak üzere dört temel direği yöneterek kalıcı bir miras bırakın. Miras Puanı, bu direklerin seviyesine göre hesaplanır. Her turda projeler uygulayın ve ulusunuzu zafere taşıyın!
        </p>
        <button id="start-game-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg">Oyunu Başlat</button>
    </div>

    <div id="game-ui" class="game-container hidden">
        <div class="game-header">
            <div class="flex flex-col md:flex-row justify-between items-center mb-4">
                <h1 class="text-2xl md:text-3xl font-bold">Geleceğin Mirası</h1>
                <div class="flex flex-col items-center mt-2 md:mt-0">
                    <span id="turn-display" class="text-lg font-bold">Tur: 1</span>
                    <span id="legacy-score" class="text-lg font-bold text-yellow-400">Miras Puanı: 0</span>
                </div>
            </div>
        </div>

        <div class="pillar-display">
            <div class="pillar-card">
                <h3 class="text-gray-300">Toplumsal Mutluluk <span id="sh-value" class="text-white font-bold float-right">50%</span></h3>
                <div class="progress-bar-container"><div id="sh-bar" class="progress-bar" style="width: 50%;"></div></div>
            </div>
            <div class="pillar-card">
                <h3 class="text-gray-300">Doğa Dengesi <span id="nb-value" class="text-white font-bold float-right">50%</span></h3>
                <div class="progress-bar-container"><div id="nb-bar" class="progress-bar" style="width: 50%;"></div></div>
            </div>
            <div class="pillar-card">
                <h3 class="text-gray-300">Teknoloji <span id="t-value" class="text-white font-bold float-right">50%</span></h3>
                <div class="progress-bar-container"><div id="t-bar" class="progress-bar" style="width: 50%;"></div></div>
            </div>
            <div class="pillar-card">
                <h3 class="text-gray-300">Küresel İtibar <span id="gr-value" class="text-white font-bold float-right">50%</span></h3>
                <div class="progress-bar-container"><div id="gr-bar" class="progress-bar" style="width: 50%;"></div></div>
            </div>
        </div>

        <div class="stats-and-actions grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="stats-panel col-span-1 md:col-span-2">
                <h2 class="text-xl font-bold mb-4">Ulusal Durum</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-gray-300">Dirhem: <span id="dirhem-display" class="text-white font-bold">1000</span></div>
                    <div class="text-gray-300">Nüfus: <span id="population-display" class="text-white font-bold">100,000</span></div>
                    <div class="text-gray-300">Günlük Gelir: <span id="income-display" class="text-white font-bold">0</span></div>
                    <div class="text-gray-300">Günlük Gider: <span id="expenses-display" class="text-white font-bold">0</span></div>
                    <div class="text-gray-300">Ulusal İstikrar: <span id="stability-display" class="text-white font-bold">100%</span></div>
                    <div class="text-gray-300">Askeri Güç: <span id="military-power-display" class="text-white font-bold">0</span></div>
                </div>
            </div>

            <div class="project-panel col-span-1">
                <h2 class="text-xl font-bold mb-4">Eylemler</h2>
                <div class="flex flex-col gap-2">
                    <button id="declare-war-btn" class="bg-red-600 hover:bg-red-700">Savaş İlan Et</button>
                    <button id="next-turn-btn" class="bg-blue-600 hover:bg-blue-700">Sıradaki Tura Geç</button>
                </div>
            </div>
        </div>

        <div class="project-panel">
            <h2 class="text-xl font-bold mb-4">Projeler</h2>
            <div id="projects-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                </div>
        </div>

        <div class="message-log">
            <h2 class="text-xl font-bold mb-2">Olay Günlüğü</h2>
            <div id="log-content"></div>
        </div>
    </div>

    <div id="game-over-screen" class="info-box p-8 hidden w-11/12 md:w-1/2">
        <h2 class="text-3xl font-bold mb-4">Oyun Sona Erdi</h2>
        <p id="game-over-message" class="mb-6"></p>
        <button onclick="location.reload()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg">Tekrar Oyna</button>
    </div>

    <script>
        // Tüm sayfa yüklendiğinde bu kod çalışır.
        window.onload = () => {

            // Genel Değişkenler
            const GAME_SPEED = 1000; // Oyun tur hızı (ms)
            const BASE_POPULATION = 100000;
            const BASE_EXPENSES = 100;

            let turn = 0;
            let dirhem = 5000;
            let socialHappiness = 50;
            let natureBalance = 50;
            let technology = 50;
            let globalReputation = 50;
            let population = BASE_POPULATION;
            let soldiers = 0;
            let militaryUpkeep = 0;
            let projectUpkeep = 0;
            let corruptionFactor = 0;
            let rebelTurn = 0;
            let isWarActive = false;
            let isGameOver = false;

            // UI Elementleri
            const startScreen = document.getElementById('start-screen');
            const gameUI = document.getElementById('game-ui');
            const startGameBtn = document.getElementById('start-game-btn');
            const turnDisplay = document.getElementById('turn-display');
            const legacyScoreEl = document.getElementById('legacy-score');
            const dirhemDisplay = document.getElementById('dirhem-display');
            const populationDisplay = document.getElementById('population-display');
            const incomeDisplay = document.getElementById('income-display');
            const expensesDisplay = document.getElementById('expenses-display');
            const stabilityDisplay = document.getElementById('stability-display');
            const militaryPowerDisplay = document.getElementById('military-power-display');
            const projectsContainer = document.getElementById('projects-container');
            const logContent = document.getElementById('log-content');
            const nextTurnBtn = document.getElementById('next-turn-btn');
            const declareWarBtn = document.getElementById('declare-war-btn');
            const gameOverScreen = document.getElementById('game-over-screen');
            const gameOverMessage = document.getElementById('game-over-message');

            const pillars = {
                sh: { value: 50, el: document.getElementById('sh-value'), bar: document.getElementById('sh-bar') },
                nb: { value: 50, el: document.getElementById('nb-value'), bar: document.getElementById('nb-bar') },
                t: { value: 50, el: document.getElementById('t-value'), bar: document.getElementById('t-bar') },
                gr: { value: 50, el: document.getElementById('gr-value'), bar: document.getElementById('gr-bar') }
            };

            const projects = [
                { name: 'Ulusal Kütüphane Projesi', cost: 500, upkeep: 10, effects: { sh: 15, gr: 5 }, description: 'Kültürel gelişimi ve toplum mutluluğunu artırır.' },
                { name: 'Gelişmiş Su Arıtma Projesi', cost: 2000, upkeep: 50, effects: { nb: 20, sh: 5 }, description: 'Doğal dengeyi iyileştirir ve halk sağlığını artırır.' },
                { name: 'Yapay Zeka Araştırma Enstitüsü', cost: 3000, upkeep: 75, effects: { t: 25 }, description: 'Teknolojik ilerlemeyi hızlandırır, verimliliği artırır.' },
                { name: 'Küresel Ticaret Antlaşması', cost: 1000, upkeep: 20, effects: { gr: 20, t: 5 }, description: 'Dünya sahnesinde itibarınızı ve ticaret gelirinizi artırır.' },
                { name: 'Askeri Eğitim Kampı', cost: 1500, upkeep: 40, effects: { sh: -5, soldiers: 500 }, description: 'Orduya yeni askerler katar, toplum mutluluğunu düşürebilir.' },
                { name: 'Park ve Rekreasyon Alanları', cost: 800, upkeep: 5, effects: { sh: 10, nb: 5 }, description: 'Halkın dinlenmesi için alanlar yaratarak mutluluğu ve doğa dengesini artırır.' },
                { name: 'Güneş Enerjisi Santrali', cost: 2500, upkeep: 30, effects: { nb: 15, t: 10 }, description: 'Çevre dostu enerji üretimi, teknolojik ilerlemeye katkı sağlar.' },
                { name: 'Diplomatik Misyon', cost: 700, upkeep: 10, effects: { gr: 15, sh: -5 }, description: 'Diğer uluslarla ilişkileri güçlendirir, ancak halkın desteğini bir miktar azaltabilir.' },
            ];

            // Fonksiyonlar
            const formatNumber = (num) => new Intl.NumberFormat('tr-TR').format(Math.floor(num));

            const updateUI = () => {
                // Direkleri güncelle
                socialHappiness = Math.max(0, Math.min(100, socialHappiness));
                natureBalance = Math.max(0, Math.min(100, natureBalance));
                technology = Math.max(0, Math.min(100, technology));
                globalReputation = Math.max(0, Math.min(100, globalReputation));

                pillars.sh.el.textContent = `${Math.floor(socialHappiness)}%`;
                pillars.sh.bar.style.width = `${socialHappiness}%`;
                pillars.nb.el.textContent = `${Math.floor(natureBalance)}%`;
                pillars.nb.bar.style.width = `${natureBalance}%`;
                pillars.t.el.textContent = `${Math.floor(technology)}%`;
                pillars.t.bar.style.width = `${technology}%`;
                pillars.gr.el.textContent = `${Math.floor(globalReputation)}%`;
                pillars.gr.bar.style.width = `${globalReputation}%`;

                // Miras Puanı hesapla
                const legacyScore = (socialHappiness * 1.5) + (natureBalance * 1.0) + (technology * 0.8) + (globalReputation * 1.2);
                const maxPillar = Math.max(socialHappiness, natureBalance, technology, globalReputation);
                const minPillar = Math.min(socialHappiness, natureBalance, technology, globalReputation);
                const balanceBonus = (maxPillar - minPillar) <= 10 ? legacyScore * 0.15 : 0;
                
                legacyScoreEl.textContent = `Miras Puanı: ${formatNumber(legacyScore + balanceBonus)}`;

                // Durum paneli
                dirhemDisplay.textContent = formatNumber(dirhem);
                populationDisplay.textContent = formatNumber(population);
                militaryPowerDisplay.textContent = formatNumber(getMilitaryPower());
                
                const productivityFactor = (0.5 * socialHappiness / 100) + (0.5 * technology / 100);
                const tradeRevenue = (globalReputation * 0.5) + 10;
                const dailyIncome = (population * productivityFactor) + tradeRevenue;
                
                incomeDisplay.textContent = formatNumber(dailyIncome);
                
                const dailyExpenses = projectUpkeep + militaryUpkeep;
                expensesDisplay.textContent = formatNumber(dailyExpenses);

                const stabilityScore = Math.min(100, Math.max(0, socialHappiness + getMilitaryPower() / 5000 - corruptionFactor));
                stabilityDisplay.textContent = `${Math.floor(stabilityScore)}%`;

                checkGameOver();
            };

            const getMilitaryPower = () => {
                // TacticalScore sabit bir değer olarak ayarlandı
                const tacticalScore = 5000; 
                return soldiers * (1 + technology / 100) + tacticalScore;
            };

            const addLog = (message) => {
                const p = document.createElement('p');
                p.textContent = `[Tur ${turn}] ${message}`;
                p.classList.add('text-sm', 'text-gray-400');
                logContent.prepend(p);
                // Sadece son 50 mesajı tut
                if (logContent.children.length > 50) {
                    logContent.removeChild(logContent.lastChild);
                }
            };
            
            const checkCorruption = () => {
                const stabilityScore = socialHappiness + getMilitaryPower() / 5000 - corruptionFactor;
                if (stabilityScore < 40) {
                    corruptionFactor = 2;
                    addLog('Uyarı: Ulusal istikrar düşük! Yolsuzluk Dirhem gelirinde %2 kayba neden oluyor.');
                } else {
                    corruptionFactor = 0;
                }
            };
            
            const checkRebellion = () => {
                const stabilityScore = socialHappiness + getMilitaryPower() / 5000 - corruptionFactor;
                if (stabilityScore < 10) {
                    rebelTurn++;
                    addLog(`KRİTİK: İsyan başladı! Toplumsal Mutluluk 5% düştü.`);
                    socialHappiness -= 5;
                    if (rebelTurn > 5) {
                        isGameOver = true;
                        gameOverMessage.textContent = 'İsyanlar kontrolden çıktı ve hükümetiniz devrildi. Geleceğiniz mahvoldu.';
                        endGame();
                    }
                } else {
                    rebelTurn = 0;
                }
            };

            const checkGameOver = () => {
                if (dirhem < -5000 || isGameOver) {
                    isGameOver = true;
                    gameOverMessage.textContent = 'Mali çöküş yaşadınız ve ulusunuzun itibarı sarsıldı. Oyun sona erdi.';
                    endGame();
                }
            };

            const endGame = () => {
                gameUI.classList.add('hidden');
                gameOverScreen.classList.remove('hidden');
            };

            const nextTurn = () => {
                turn++;
                turnDisplay.textContent = `Tur: ${turn}`;
                
                const productivityFactor = (0.5 * socialHappiness / 100) + (0.5 * technology / 100);
                const tradeRevenue = (globalReputation * 0.5) + 10;
                const dailyIncome = (population * productivityFactor) + tradeRevenue;
                const dailyExpenses = projectUpkeep + militaryUpkeep;

                dirhem += dailyIncome - dailyExpenses;

                if (isWarActive) {
                    globalReputation -= 5;
                    addLog('Savaş durumu devam ediyor. Küresel İtibarınız düşüyor.');
                }
                
                checkCorruption();
                checkRebellion();
                updateUI();
                addLog('Sıradaki tura geçildi.');
            };

            const handleProjectClick = (project) => {
                if (dirhem >= project.cost) {
                    dirhem -= project.cost;
                    
                    socialHappiness += project.effects.sh || 0;
                    natureBalance += project.effects.nb || 0;
                    technology += project.effects.t || 0;
                    globalReputation += project.effects.gr || 0;
                    
                    projectUpkeep += project.upkeep || 0;
                    soldiers += project.effects.soldiers || 0;
                    militaryUpkeep = (soldiers / 100) * (population / 100);

                    addLog(`${project.name} başarıyla tamamlandı. Maliyet: ${formatNumber(project.cost)} Dirhem.`);
                    updateUI();
                } else {
                    addLog(`${project.name} projesi için yeterli Dirhem yok!`);
                }
            };
            
            const handleDeclareWar = () => {
                const warCost = 5000 + 0.2 * getMilitaryPower();
                if (isWarActive) {
                    addLog('Zaten savaş durumundasınız.');
                    return;
                }
                if (dirhem < warCost) {
                    addLog('Savaş ilan etmek için yeterli Dirhem yok!');
                    return;
                }
                
                dirhem -= warCost;
                isWarActive = true;
                
                const outcome = Math.random();
                if (outcome > 0.4) { // %60 kazanma şansı
                    addLog('Savaş ilan edildi! Zaferle çıktınız!');
                    socialHappiness = Math.min(100, socialHappiness + 25);
                    globalReputation = Math.min(100, globalReputation + 10);
                } else {
                    addLog('Savaş ilan edildi! Mağlup oldunuz!');
                    socialHappiness = Math.max(0, socialHappiness - 50);
                    globalReputation = Math.max(0, globalReputation - 20);
                }
                
                // Savaşın doğal dengeye etkisi
                natureBalance = Math.max(0, natureBalance - (Math.random() * 10 + 5)); 
                
                isWarActive = false;
                updateUI();
            };

            const createProjectCards = () => {
                projects.forEach(project => {
                    const card = document.createElement('div');
                    card.className = 'project-card cursor-pointer hover:bg-gray-700 transition duration-300 rounded-lg p-4 shadow-md';
                    card.innerHTML = `
                        <h4 class="text-lg font-bold text-white mb-1">${project.name}</h4>
                        <p class="text-sm text-gray-400 mb-2">${project.description}</p>
                        <p class="text-sm font-semibold text-gray-300">Maliyet: <span class="text-yellow-300">${formatNumber(project.cost)} Dirhem</span></p>
                        <p class="text-sm font-semibold text-gray-300">Bakım: <span class="text-red-300">${project.upkeep || 0} Dirhem/tur</span></p>
                    `;
                    card.addEventListener('click', () => handleProjectClick(project));
                    projectsContainer.appendChild(card);
                });
            };

            // Event Listeners
            startGameBtn.addEventListener('click', () => {
                console.log('Oyun başlatılıyor...');
                startScreen.classList.add('hidden');
                gameUI.classList.remove('hidden');
                createProjectCards();
                updateUI();
                addLog('Oyun Başladı. Ulusunuzun kaderi sizin ellerinizde!');
            });
            
            nextTurnBtn.addEventListener('click', nextTurn);
            declareWarBtn.addEventListener('click', handleDeclareWar);
            
            const parallaxLayers = document.querySelectorAll('.parallax-layer');
            document.body.addEventListener('mousemove', (e) => {
                const x = (e.clientX / window.innerWidth - 0.5);
                const y = (e.clientY / window.innerHeight - 0.5);
                parallaxLayers[0].style.transform = `translate(${x * 10}px, ${y * 10}px)`;
                parallaxLayers[1].style.transform = `translate(${x * 20}px, ${y * 20}px)`;
                parallaxLayers[2].style.transform = `translate(${x * 30}px, ${y * 30}px)`;
            });

        };
    </script>

</body>
</html>
